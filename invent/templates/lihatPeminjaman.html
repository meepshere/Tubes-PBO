{% extends 'base.html' %}

{% block head %}
<title>Inventaris</title>
<script src="{{ url_for('static', filename="js/basepdf.js") }}""></script>
<script src="{{ url_for('static', filename="js/pdf.js") }}""></script>
{% endblock %}

{% block body %}
<div class="content" id="printini">
    <h1 style="text-align: center">Inventaris</h1>
    <h1 style="text-align: center">{{judul}}</h1>
    {% if dafPinjam |length < 1 %}
    <h4 style="text-align: center">gaada barang bang..</h4>
    {% else %}
    <table>
        <tr>
            <th>Perihal Peminjaman</th>
            <th>Nama Barang</th>
            <th>Ruang</th>
            <th>Gedung</th>
            <th>Tgl Pinjam</th>
            <th>Kondisi </th>
        </tr>
        {% for i in range(0, dafPinjam | length) %}
            <tr>
                <td>{{ dafPinjam[i].kodePeminjaman }}</td>
                <td>{{ dafPinjam[i].barangDipinjam.namaBarang }}</td>
                <td>{{ dafPinjam[i].tempatGedung.namaGedung }}</td>
                <td>{{ dafPinjam[i].tempatKelas.namaRuang }}</td>
                <td>{{ dafPinjam[i].tgl }}</td>
                <td>{{ dafPinjam[i].kondisi }}</td>
                <td>
                    <a href="/detailPeminjaman/{{dafPinjam[i].id}}">detail</a>
                    <br>
                    <a href="/viewBast/{{dafPinjam[i].id}}" target="_blank"   >download file</a>
                </td>
            </tr>
        {% endfor %}
    </table>
    <br>
    <br>
    {% endif %}
    <a href="/menu">balik</a>
</div>

<div class="donlot" style="text-align: center">
    <button class="btn btn-primary" id="download"> download pdf</button>
</div>
<div class="form">
    <form action="/lihatPeminjaman" method="POST" enctype="multipart/form-data">
        <a>Gedung bang :</a>
        <br>
        <select name="gedungnya" id="gedungnya">
            <option value=0></option>
            {% for t in dafGedung %}
            <option value={{t.id}}>{{t.namaGedung}}</option>
            {% endfor %}
        </select>
        <br>
        <a>Ruang bang :</a>
        <br>
        <select name="ruangnya" id="ruangnya">
            <option value=0></option>
            {% for t in dafKelas %}
            <option value={{t.id}}>{{t.namaRuang}}</option>
            {% endfor %}
        </select>
        <br>
        <a>Lihat peminjaman pada barang :</a>
        <br>
        <select name="barangnya" id="barangnya">
            <option value=0></option>
            {% for t in dafBarang %}
            <option value={{t.id}}>{{t.namaBarang}}</option>
            {% endfor %}
        </select>
        <input type="submit" value="lihat ruang">
    </form>
    <a href="/lihatPeminjaman">reset</a>
</div>
<script>
    country_select = document.getElementById('gedungnya');
    state_select = document.getElementById('ruangnya');
    barang_select = document.getElementById('barangnya');
     
    country_select.onchange = function(){
     country = country_select.value;
     fetch('/ruang/' + country).then(function(response){
      response.json().then(function(data) {
       optionHTML = '';
       optionHTML += '<option value=0> </option>'
       for (state of data.ruangarray) {
        optionHTML += '<option value="' + state.id +'">' + state.name + '</option>'
       }
       state_select.innerHTML = optionHTML;
      });
     });
     fetch('/barangG/' + country).then(function(response){
      response.json().then(function(data) {
       optionHTML = '';
       optionHTML += '<option value=0> </option>'
       for (brg of data.brgarray) {
        optionHTML += '<option value="' + brg.id +'">' + brg.name + '</option>'
       }
       barang_select.innerHTML = optionHTML;
      });
     });
    }
    state_select.onchange = function(){
     state = state_select.value;
     fetch('/barang/' + state).then(function(response){
      response.json().then(function(data) {
       optionHTML = '';
       optionHTML += '<option value=0> </option>'
       for (brg of data.brgarray) {
        optionHTML += '<option value="' + brg.id +'">' + brg.name + '</option>'
       }
       barang_select.innerHTML = optionHTML;
      });
     });
    }
</script>
{% endblock %}